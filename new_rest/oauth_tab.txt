CREATE TABLE oauth_client_details (
  client_id VARCHAR(256) PRIMARY KEY,
  resource_ids VARCHAR(256),
  client_secret VARCHAR(256),
  scope VARCHAR(256),
  authorized_grant_types VARCHAR(256),
  web_server_redirect_uri VARCHAR(256),
  authorities VARCHAR(256),
  access_token_validity INTEGER,
  refresh_token_validity INTEGER,
  additional_information VARCHAR(4096),
  autoapprove VARCHAR(256)
);

CREATE TABLE oauth_client_token (
  token_id VARCHAR(256),
  token BYTEA,
  authentication_id VARCHAR(256) PRIMARY KEY,
  user_name VARCHAR(256),
  client_id VARCHAR(256)
);

CREATE TABLE oauth_access_token (
  token_id VARCHAR(256),
  token BYTEA,
  authentication_id VARCHAR(256) PRIMARY KEY,
  user_name VARCHAR(256),
  client_id VARCHAR(256),
  authentication BYTEA,
  refresh_token VARCHAR(256)
); 
CREATE TABLE oauth_refresh_token (
  token_id VARCHAR(256),
  token BYTEA,
  authentication BYTEA
);

CREATE TABLE oauth_code (
  code VARCHAR(256), authentication BYTEA
);

CREATE TABLE oauth_approvals (
	userId VARCHAR(256),
	clientId VARCHAR(256),
	scope VARCHAR(256),
	status VARCHAR(10),
	expiresAt TIMESTAMP,
	lastModifiedAt TIMESTAMP
);

-----------------------------------------------------
CREATE TABLE oauth_users (
  username VARCHAR(50)  NOT NULL PRIMARY KEY,
  password VARCHAR(200) NOT NULL,
  enabled  BOOLEAN      NOT NULL
);

CREATE TABLE oauth_user_authorities (
  username  VARCHAR(50) NOT NULL,
  authority VARCHAR(50) NOT NULL,
  CONSTRAINT fk_oauth_user_authorities_oauth_users FOREIGN KEY (username) REFERENCES oauth_users(username)
);

CREATE UNIQUE INDEX ix_auth_username
  ON oauth_user_authorities(username, authority);

-----------------
INSERT INTO oauth_users(username, password, enabled)
VALUES ('user', 'user', TRUE);
INSERT INTO oauth_users(username, password, enabled)
VALUES ('admin', 'admin', TRUE);
INSERT INTO oauth_users(username, password, enabled)
VALUES ('admin', '$2a$10$eJhibugweC0auIwAixMNWePIKMlnsWSFCju29btvi2MwHUI1MZJgO', TRUE);

INSERT INTO oauth_user_authorities(username, authority) VALUES ('user', 'ROLE_USER');
INSERT INTO oauth_user_authorities(username, authority) VALUES ('admin', 'ROLE_ADMIN');

INSERT INTO oauth_client_details (client_id, client_secret, scope, access_token_validity, authorized_grant_types)
VALUES
  ('client', 'secret', 'read,write', 3600, 'password,refresh_token,authorization_code,implicit');

-------------------

DROP TABLE oauth_client_details;
DROP TABLE oauth_client_token;
DROP TABLE oauth_access_token;
DROP TABLE oauth_refresh_token;
DROP TABLE oauth_code;
DROP TABLE oauth_approvals;
DROP TABLE oauth_users;
DROP TABLE oauth_user_authorities;

-----------------------------

DELETE FROM oauth_client_details;
DELETE FROM oauth_client_token;
DELETE FROM oauth_access_token;
DELETE FROM oauth_refresh_token;
DELETE FROM oauth_code;
DELETE FROM oauth_approvals;
DELETE FROM oauth_user_authorities;
DELETE FROM oauth_users;

DELETE FROM Users;
DELETE FROM Images;
